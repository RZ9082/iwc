- doc: Test outline for mgnify-amplicon-pipeline-complete.ga
  job:
    SRA accession list:
      class: File
      path: test-data/accessions.csv
    Clan information file:
      class: File
      path: test-data/ribo.claninfo
    Covariance models:
      class: File
      location: "ftp://ftp.ebi.ac.uk/pub/databases/metagenomics/pipeline-5.0/ref-dbs/rfam_models/ribosomal_models/ribo.cm"
  outputs:
    SE_MultiQC_report:
      asserts:
        - that: has_text
          text: "DRR010481_ambiguous_base_filtering"
        - that: has_text
          text: "<span class=\"val\">84.0%</span>"
        - that: has_text
          text: "DRR010481_initial_reads"
        - that: has_text
          text: "<span class=\"val\">84.8%</span>"
        - that: has_text
          text: "DRR010481_length_filtering"
        - that: has_text
          text: "DRR010481_trimming"
    SE_QC_processed_FASTA:
      element_tests:
        DRR010481:
          path: test-data/SE_QC_processed_FASTA/DRR010481.fasta
          compare: diff
          lines_diff: 0
    SE_MultiQC_stats:
      element_tests:
        fastqc:
          path: test-data/SE_MultiQC_stats/fastqc.tabular
          compare: diff
          lines_diff: 0
        general_stats:
          path: test-data/SE_MultiQC_stats/general_stats.tabular
          compar: diff
          lines_diff: 0
        sources:
          asserts:
            - that: has_text
              text: "FastQC	all_sections	DRR010481_ambiguous_base_filtering"
            - that: has_text
              text: "FastQC	all_sections	DRR010481_initial_reads"        
            - that: has_text
              text: "FastQC	all_sections	DRR010481_length_filtering"        
            - that: has_text
              text: "FastQC	all_sections	DRR010481_trimming"        
    PE_MultiQC_report:
      asserts:
        - that: has_text
          text: "ERR2715528_ambiguous_base_filtering"
        - that: has_text
          text: "ERR2715528_initial_reads"
        - that: has_text
          text: "ERR2715528_length_filtering"
        - that: has_text
          text: "ERR2715528_trimming"
        - that: has_text
          text: "<span class=\"val\">92.2%</span>"
    PE_MultiQC_stats:
      element_tests:
        fastqc:
          path: test-data/PE_MultiQC_stats/fastqc.tabular
          compare: diff
          lines_diff: 0
        general_stats:
          path: test-data/PE_MultiQC_stats/general_stats.tabular
          compare: diff
          lines_diff: 0
        sources:
          asserts:
            - that: has_text
              text: "FastQC	all_sections	ERR2715528_ambiguous_base_filtering"
            - that: has_text
              text: "FastQC	all_sections	ERR2715528_initial_reads"        
            - that: has_text
              text: "FastQC	all_sections	ERR2715528_length_filtering"        
            - that: has_text
              text: "FastQC	all_sections	ERR2715528_trimming"
    PE_QC_processed_FASTA:
      element_tests:
        ERR2715528:
          path: test-data/PE_QC_processed_FASTA/ERR2715528.fasta
          compare: diff
          lines_diff: 0
    LSU_FASTA:
      element_tests:
        DRR010481:
          path: test-data/LSU_FASTA/DRR010481.fasta
          compare: contains
    Classifications_SSU_SILVA:
      element_tests:
        ERR2715528:
          asserts:
            - that: has_text
              text: "# mapseq v1.2.6 (Jan 20 2023)"
            - that: has_text
              text: "SILVA"
            - that: has_n_columns
              comment: "#"
              n: 15
    OTU_SSU_SILVA:
      element_tests:
        ERR2715528:
          asserts:
            - that: has_text
              text: "# Constructed from biom file"
            - that: has_text
              text: "# OTU ID"
            - that: has_text
              text: "Unspecified"
            - that: has_text
              text: "taxonomy"
            - that: has_text
              text: "taxid"
            - that: has_n_columns
              comment: "#"
              n: 4
    OTU_LSU_SILVA:
      element_tests:
        DRR010481:
          asserts:
            - that: has_text
              text: "# Constructed from biom file"
            - that: has_text
              text: "# OTU ID"
            - that: has_text
              text: "Unspecified"
            - that: has_text
              text: "taxonomy"
            - that: has_text
              text: "taxid"
            - that: has_n_columns
              comment: "#"
              n: 4
    HDF5_SSU_SILVA:
      element_tests:
        ERR2715528:
          asserts:
            - that: has_size
              value: 37000
              delta: 10000
    JSON_SSU_SILVA:
      element_tests:
        ERR2715528:
          asserts:
            - that: has_text
              text: "\"type\": \"OTU table\""
    Krona_SSU_SILVA:
      asserts:
            - that: has_text
              text: "ERR2715528"
    HDF5_LSU_SILVA:
      element_tests:
        DRR010481:
          asserts:
            - that: has_size
              value: 37000
              delta: 10000
    JSON_LSU_SILVA:
      element_tests:
        DRR010481:
          asserts:
            - that: has_text
              text: "\"type\": \"OTU table\""
    Krona_LSU_SILVA:
      asserts:
            - that: has_text
              text: "DRR010481"
    Classifications_LSU_SILVA:
      element_tests:
        DRR010481:
          asserts:
            - that: has_text
              text: "# mapseq v1.2.6 (Jan 20 2023)"
            - that: has_text
              text: "SILVA"
            - that: has_n_columns
              comment: "#"
              n: 15
    SSU_FASTA:
      element_tests:
        ERR2715528:
          path: test-data/SSU_FASTA/ERR2715528.fasta
          compare: contains
    LSU_SSU_BED:
      element_tests:
        DRR010481:
          path: test-data/LSU_SSU_BED/DRR010481.bed
          compare: diff
          lines_diff: 0
        ERR2715528:
          path: test-data/LSU_SSU_BED/ERR2715528.bed
          compare: diff
          lines_diff: 0
    Classifications_ITSoneDB:
      element_tests:
        DRR010481:
          asserts:
            - that: has_text
              text: "# mapseq v1.2.6 (Jan 20 2023)"
            - that: has_text
              text: "ITSone"
            - that: has_n_columns
              comment: "#"
              n: 15
        ERR2715528:
          asserts:
            - that: has_text
              text: "# mapseq v1.2.6 (Jan 20 2023)"
            - that: has_text
              text: "ITSone"
            - that: has_n_columns
              comment: "#"
              n: 15
    ITS_FASTA:
      element_tests:
        DRR010481:
          path: test-data/ITS_FASTA/DRR010481.fasta
          compare: contains
        ERR2715528:
          path: test-data/ITS_FASTA/ERR2715528.fasta
          compare: contains
    JSON_ITS_UNITE:
      element_tests:
        DRR010481:
          asserts:
            - that: has_text
              text: "\"type\": \"OTU table\""
        ERR2715528:
          asserts:
            - that: has_text
              text: "\"type\": \"OTU table\""
    Krona_ITS_UNITE:
      asserts:
            - that: has_text
              text: "DRR010481"
            - that: has_text
              text: "ERR2715528"
    HDF5_ITS_UNITE:
      element_tests:
        DRR010481:
          asserts:
            - that: has_size
              value: 37000
              delta: 10000
        ERR2715528:
          asserts:
            - that: has_size
              value: 72000
              delta: 10000
    Krona_ITSoneDB:
      asserts:
        - that: has_text
          text: "DRR010481"
        - that: has_text
          text: "ERR2715528"
    JSON_ITSoneDB:
      element_tests:
        DRR010481:
          asserts:
            - that: has_text
              text: "\"type\": \"OTU table\""
        ERR2715528:
          asserts:
            - that: has_text
              text: "\"type\": \"OTU table\""
    HDF5_ITSoneDB:
      element_tests:
        DRR010481:
          asserts:
            - that: has_size
              value: 37000
              delta: 10000
        ERR2715528:
          asserts:
            - that: has_size
              value: 72000
              delta: 10000
    Classifications_ITS_UNITE:
      element_tests:
        DRR010481:
          asserts:
            - that: has_text
              text: "# mapseq v1.2.6 (Jan 20 2023)"
            - that: has_text
              text: "UNITE"
            - that: has_n_columns
              comment: "#"
              n: 15
        ERR2715528:
          asserts:
            - that: has_text
              text: "# mapseq v1.2.6 (Jan 20 2023)"
            - that: has_text
              text: "UNITE"
            - that: has_n_columns
              comment: "#"
              n: 15
    OTU_ITS_UNITE:
      element_tests:
        DRR010481:
          asserts:
            - that: has_text
              text: "# Constructed from biom file"
            - that: has_text
              text: "# OTU ID"
            - that: has_text
              text: "Unspecified"
            - that: has_text
              text: "taxonomy"
            - that: has_text
              text: "taxid"
            - that: has_n_columns
              comment: "#"
              n: 4
        ERR2715528:
          asserts:
            - that: has_text
              text: "# Constructed from biom file"
            - that: has_text
              text: "# OTU ID"
            - that: has_text
              text: "Unspecified"
            - that: has_text
              text: "taxonomy"
            - that: has_text
              text: "taxid"
            - that: has_n_columns
              comment: "#"
              n: 4
    OTU_ITSoneDB:
      element_tests:
        DRR010481:
          asserts:
            - that: has_text
              text: "# Constructed from biom file"
            - that: has_text
              text: "# OTU ID"
            - that: has_text
              text: "Unspecified"
            - that: has_text
              text: "taxonomy"
            - that: has_text
              text: "taxid"
            - that: has_n_columns
              comment: "#"
              n: 4
        ERR2715528:
          asserts:
            - that: has_text
              text: "# Constructed from biom file"
            - that: has_text
              text: "# OTU ID"
            - that: has_text
              text: "Unspecified"
            - that: has_text
              text: "taxonomy"
            - that: has_text
              text: "taxid"
            - that: has_n_columns
              comment: "#"
              n: 4
    ITSoneDB_phylum_taxonomic_summary_table:
      asserts:
        - that: has_text
          text: 'superkingdom	kingdom	phylum	DRR010481	ERR2715528'
        - that: has_n_columns
          n: 5
          delta: 2
    ITSoneDB_taxonomic_summary_table:
      asserts:
        - that: has_text
          text: '#SampleID	DRR010481	ERR2715528'
        - that: has_n_columns
          n: 3
          delta: 17
    LSU_phylum_taxonomic_summary_table:
      asserts:
        - that: has_text
          text: 'superkingdom	kingdom	phylum	DRR010481	ERR2715528'
        - that: has_n_columns
          n: 5
          delta: 1
    LSU_taxonomic_summary_table:
      asserts:
        - that: has_text
          text: '#SampleID	DRR010481	ERR2715528'
        - that: has_n_columns
          n: 3
          delta: 2
    SSU_phylum_taxonomic_summary_table:
      asserts:
        - that: has_text
          text: 'superkingdom	kingdom	phylum	ERR2715528'
        - that: has_n_columns
          n: 4
          delta: 2
    SSU_taxonomic_summary_table:
      asserts:
        - that: has_text
          text: '#SampleID	ERR2715528'
        - that: has_n_columns
          n: 2
          delta: 2
    UNITE_phylum_taxonomic_summary_table:
      asserts:
        - that: has_text
          text: 'superkingdom	kingdom	phylum	DRR010481	ERR2715528'
        - that: has_n_columns
          n: 5
          delta: 2
    UNITE_taxonomic_summary_table:
      asserts:
        - that: has_text
          text: '#SampleID	DRR010481	ERR2715528'
        - that: has_n_columns
          n: 3
          delta: 19